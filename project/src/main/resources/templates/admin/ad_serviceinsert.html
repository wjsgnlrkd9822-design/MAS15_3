<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="_csrf" th:content="${_csrf.token}">
<meta name="_csrf_header" th:content="${_csrf.headerName}">
<title>ì„œë¹„ìŠ¤ ì¶”ê°€</title>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<style>
body { background-color: #f5f6f7; }
.sidebar { width: 240px; background-color: #1f2933; color: #fff; }   
.sidebar h5 { font-weight: 600; }
.sidebar .nav-link { color: #cbd5e1; padding: 10px 14px; border-radius: 6px; }
.sidebar .nav-link.active, .sidebar .nav-link:hover { background-color: #374151; color: #fff; }
.header { background: #fff; border-bottom: 1px solid #e5e7eb; padding: 1rem; font-weight: 600; }
</style>
</head>
<body>
<div class="d-flex">

    <!-- ì‚¬ì´ë“œë°” -->
    <aside class="sidebar p-4 vh-100">
        <h5 class="mb-4">ê´€ë¦¬ì í˜ì´ì§€</h5>
         <nav class="nav flex-column gap-1">
            <a class="nav-link" th:href="@{/admin}">ğŸ“Š ë§¤ì¶œ ì¡°íšŒ</a>
            <a class="nav-link" th:href="@{/admin/usermanage}">ğŸ‘¥ íšŒì› ê´€ë¦¬</a>
            <a class="nav-link active" th:href="@{/admin/service}">âš™ï¸ ì„œë¹„ìŠ¤ ë° ì‹œì„¤ ê´€ë¦¬</a>
            <a class="nav-link" th:href="@{/admin/trainer}">ğŸ‡ í›ˆë ¨ì‚¬ ê´€ë¦¬</a>
            <a class="nav-link" th:href="@{/admin/notice}">ğŸ“ ê³µì§€ì‚¬í•­</a>
            <a class="nav-link" th:href="@{/admin/petstatus}">ğŸ¾ ë°˜ë ¤ê²¬ ìƒíƒœ ê´€ë¦¬</a>
        </nav>
    </aside>

    <!-- ë©”ì¸ ì˜ì—­ -->
    <div class="flex-fill p-4">
        <div class="header mb-4">ì„œë¹„ìŠ¤ ì¶”ê°€</div>

        <div class="card">
            <div class="card-body">
                <form action="/admin/serviceadd" method="post" id="serviceForm" >
                    <div class="mb-3">
                        <label class="form-label">ì„œë¹„ìŠ¤ ì´ë¦„</label>
                        <input type="text" class="form-control" name="serviceName"
                        id="serviceName" placeholder="ì˜ˆ: ì• ê²¬ ë¯¸ìš©" required>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">ê°€ê²©</label>
                        <input type="number" class="form-control" name="servicePrice" 
                        id="servicePrice"   placeholder="ì˜ˆ: 30000" required>

                    </div>
                    <div class="mb-3">
                        <label class="form-label">ì„œë¹„ìŠ¤ ì„¤ëª…</label>
                        <textarea class="form-control" name="description" rows="4"
                        id="description" placeholder="ì„œë¹„ìŠ¤ íŠ¹ì§•, ì£¼ì˜ì‚¬í•­"></textarea>
                    </div>

                    <div class="d-flex justify-content-end gap-2">
                        <a th:href="@{/admin/service}" class="btn btn-secondary">ëª©ë¡ìœ¼ë¡œ</a>
                        <button type="submit" class="btn btn-primary">ë“±ë¡í•˜ê¸°</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script>
 document.getElementById('serviceForm').addEventListener('submit', async function(e) {
    e.preventDefault();

    const csrfToken = document.querySelector('meta[name="_csrf"]').content;
    const csrfHeader = document.querySelector('meta[name="_csrf_header"]').content;

    const data = {
        serviceName: document.getElementById('serviceName').value,
        servicePrice: parseInt(document.getElementById('servicePrice').value),
        description: document.getElementById('description').value
    };

    try {
        const res = await fetch('/admin/serviceadd', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                [csrfHeader]: csrfToken
            },
            body: JSON.stringify(data)
        });

        const result = await res.text();

        if (result === 'SUCCESS') {
            alert('ì„œë¹„ìŠ¤ê°€ ì„±ê³µì ìœ¼ë¡œ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤.');
            window.location.href = '/admin/service';
        } else {
            alert('ì„œë¹„ìŠ¤ ì¶”ê°€ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.');
        }
    } catch (err) {
        console.error(err);
        alert('ì„œë²„ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
    }
});

</script>

</body>
</html>
